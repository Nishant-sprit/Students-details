<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
    <title>Students Count</title>
    <script src="table2excel.js"></script>
    <link rel="stylesheet" href="style.css">
</head>

<body>


    <nav class="navbar bg-light">
     <div class="container-fluid">
            <a class="navbar-brand" href="#">
                <!-- <img src="bar-chart-line-fill.svg" alt="" width="30" height="24" class="d-inline-block align-text-top"> -->
                Students Count
            </a>  
        </div>
    </nav>


    <table id="table">
        <tbody>
            <tr>
                <td> Names</td>
                <td>
                    <input type="text" name="" id="tareek" style="width: 150px;">
                </td>
            </tr>


            <tr>
                <td>

                    <button type="button" class="btn btn-primary" id="btn-1" onclick="increment1()">Rohan</button>
                </td>
                <td>
                    <input type="text" id="val1">
                </td>
            </tr>
            <tr>
                <td>
                    <button class="btn btn-primary" id="btn-2" onclick="increment2()">Varun</button>
                </td>
                <td><input type="text" id="val2"></td>
            </tr>
            <tr>
                <td>
                    <button class="btn btn-primary" id="btn-3" onclick="increment3()">Santosh</button>
                </td>
                <td>
                    <input type="text" id="val3">
                </td>
            </tr>
            <tr>
                <td>
                    <button class="btn btn-primary" id="btn-4" onclick="increment4()">Nishant</button>
                </td>
                <td>
                    <input type="text" id="val4">
                </td>
            </tr>
            <tr>
                <td>
                    <button class="btn" id="btn-5" onclick="increment5()">Monu</button>
                </td>
                <td>
                    <input type="text" id="val5">
                </td>
            </tr>
            <tr>
                <td>
                    <button class="btn" id="btn-6" onclick="increment6()">Sonu</button>
                </td>
                <td>
                    <input type="text" id="val6">
                </td>
            </tr>
        </tbody>
    </table>
    <br>
    <div class="last">
        <button id="downloadexcel" class="btn btn-outline-dark">Export</button>
    </div>

    <button id="reset" class="btn btn-outline-secondary" onclick="resetting()">Reset</button>


    <script>

        var btn1 = document.getElementById('btn-1');
        var btn2 = document.getElementById('btn-2');
        var btn3 = document.getElementById('btn-3');
        var btn4 = document.getElementById('btn-4');
        var btn5 = document.getElementById('btn-5');
        var btn6 = document.getElementById('btn-6');
        var inp1 = document.getElementById('val1');
        var inp2 = document.getElementById('val2');
        var inp3 = document.getElementById('val3');
        var inp4 = document.getElementById('val4');
        var inp5 = document.getElementById('val5');
        var inp6 = document.getElementById('val6');
        var din = document.getElementById('tareek');

        var dateObj = new Date();
        var month = dateObj.getUTCMonth() + 1; //months from 1-12
        var day = dateObj.getUTCDate();
        var year = dateObj.getUTCFullYear();

        newdate = day + " " + "/" + " " + month + " " + "/" + " " + year;




        localStorage.setItem("date", newdate);
        din.value = localStorage.getItem("date");




        inp1.value = localStorage.getItem("key1");
        inp2.value = localStorage.getItem("key2");
        inp3.value = localStorage.getItem("key3");
        inp4.value = localStorage.getItem("key4");
        inp5.value = localStorage.getItem("key5");
        inp6.value = localStorage.getItem("key6");

        function increment1() {

            if (btn1) {
                inp1.value++;
                localStorage.setItem("key1", inp1.value);
            }
        }

        function increment2() {

            if (btn2) {
                inp2.value++;
                localStorage.setItem("key2", inp2.value);
            }
        }

        function increment3() {

            if (btn3) {
                inp3.value++;
                localStorage.setItem("key3", inp3.value);
            }
        }

        function increment4() {

            if (btn4) {
                inp4.value++;
                localStorage.setItem("key4", inp4.value);
            }
        }

        function increment5() {

            if (btn5) {
                inp5.value++;
                localStorage.setItem("key5", inp5.value);
            }
        }

        function increment6() {

            if (btn6) {
                inp6.value++;
                localStorage.setItem("key6", inp6.value);
            }
        }

        function resetting() {


            let text = "Press a button!\n For reset!";
            if (confirm(text) == true) {
                inp1.value = 0;
                inp2.value = 0;
                inp3.value = 0;
                inp4.value = 0;
                inp5.value = 0;
                inp6.value = 0;

                localStorage.setItem("key1", '0');
                localStorage.setItem("key2", '0');
                localStorage.setItem("key3", '0');
                localStorage.setItem("key4", '0');
                localStorage.setItem("key5", '0');
                localStorage.setItem("key6", '0');
            } 
            else {
            }
        }

        document.getElementById('downloadexcel').addEventListener('click', function () {
            var table2excel = new Table2Excel();
            table2excel.export(document.querySelectorAll("#table"));
        })
    </script>
</body>

</html>